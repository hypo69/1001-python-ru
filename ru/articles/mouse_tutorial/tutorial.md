
### 1. PyAutoGUI

`PyAutoGUI` — это мощная и простая в использовании кроссплатформенная библиотека, которая позволяет Python-скриптам управлять мышью и клавиатурой, делать скриншоты и выполнять другие задачи автоматизации GUI.

**Установка:**

```bash
pip install pyautogui
```

**Примеры использования:**

*   **Перемещение мыши:**
    ```python
    import pyautogui
    import time

    time.sleep(2) # Даем время переключиться на другое окно
    pyautogui.moveTo(100, 150, duration=1) # Перемещает курсор на координаты (100, 150) за 1 секунду
    ```

*   **Нажатие кнопки мыши:**
    ```python
    import pyautogui
    import time

    time.sleep(2)
    pyautogui.click(200, 250) # Кликает левой кнопкой мыши по координатам (200, 250)
    pyautogui.rightClick() # Кликает правой кнопкой мыши по текущему положению курсора
    pyautogui.doubleClick() # Двойной клик
    ```

*   **Перетаскивание (drag and drop):**
    ```python
    import pyautogui
    import time

    time.sleep(2)
    pyautogui.moveTo(500, 500, duration=1) # Перемещаемся к начальной точке
    pyautogui.dragTo(600, 600, duration=1) # Перетаскиваем до (600, 600)
    ```

*   **Нажатие клавиш:**
    ```python
    import pyautogui
    import time

    time.sleep(2)
    pyautogui.write('Привет, мир!', interval=0.1) # Вводит текст с задержкой 0.1 секунды между символами
    pyautogui.press('enter') # Нажимает клавишу Enter
    pyautogui.hotkey('ctrl', 'shift', 'esc') # Нажимает Ctrl+Shift+Esc
    ```

*   **Получение текущего положения курсора:**
    ```python
    import pyautogui
    x, y = pyautogui.position()
    print(f"Текущие координаты: X={x}, Y={y}")
    ```

**Особенности и замечания:**
*   `PyAutoGUI` работает, имитируя ввод пользователя на уровне операционной системы.
*   **Осторожно:** Скрипты могут быстро выйти из-под контроля. `PyAutoGUI` имеет встроенную функцию "failsafe": переместите курсор мыши в один из четырех углов экрана, чтобы остановить выполнение скрипта. По умолчанию это левый верхний угол.
*   Для работы на Linux может потребоваться установка дополнительных зависимостей (например, `scrot` для скриншотов, `python3-tk` или `python3-dev` для некоторых функций).

### 2. pynput

`pynput` — это библиотека, которая позволяет контролировать и мониторить ввод с мыши и клавиатуры. Она более низкоуровневая, чем `PyAutoGUI`, и отлично подходит для создания глобальных слушателей событий (например, отслеживание нажатий клавиш или кликов мыши в любом приложении) или для более точного контроля над вводом.

**Установка:**

```bash
pip install pynput
```

**Примеры использования:**

*   **Управление мышью:**
    ```python
    from pynput.mouse import Button, Controller
    import time

    mouse = Controller()

    time.sleep(2)
    print(f"Текущая позиция указателя: {mouse.position}")

    mouse.position = (10, 20) # Устанавливает новую позицию
    print(f"Новая позиция указателя: {mouse.position}")

    mouse.move(5, -5) # Перемещает указатель относительно текущей позиции
    print(f"Позиция после относительного перемещения: {mouse.position}")

    mouse.click(Button.left, 1) # Клик левой кнопкой 1 раз
    mouse.press(Button.right) # Нажимает правую кнопку
    mouse.release(Button.right) # Отпускает правую кнопку
    mouse.scroll(0, 2) # Прокрутка колеса мыши вверх на 2 единицы
    ```

*   **Управление клавиатурой:**
    ```python
    from pynput.keyboard import Key, Controller
    import time

    keyboard = Controller()

    time.sleep(2)
    keyboard.press(Key.space) # Нажимает пробел
    keyboard.release(Key.space) # Отпускает пробел

    keyboard.press('a') # Нажимает клавишу 'a'
    keyboard.release('a') # Отпускает клавишу 'a'

    keyboard.type('Привет, мир!') # Вводит строку

    # Нажатие комбинации клавиш
    with keyboard.pressed(Key.ctrl):
        keyboard.press('c')
        keyboard.release('c')
    ```

*   **Слушатели событий (мониторинг):**
    ```python
    from pynput import mouse, keyboard

    def on_press(key):
        try:
            print(f'Буквенно-цифровая клавиша {key.char} нажата')
        except AttributeError:
            print(f'Специальная клавиша {key} нажата')

    def on_release(key):
        print(f'Клавиша {key} отпущена')
        if key == keyboard.Key.esc:
            # Остановить слушатель
            return False

    def on_click(x, y, button, pressed):
        print(f'{("Нажата" if pressed else "Отпущена")} кнопка {button} в {x, y}')
        if not pressed:
            # Остановить слушатель, если кнопка отпущена
            return False

    # Запускаем слушатель клавиатуры в фоновом режиме
    with keyboard.Listener(on_press=on_press, on_release=on_release) as listener_kb:
        # Запускаем слушатель мыши в фоновом режиме
        with mouse.Listener(on_click=on_click) as listener_mouse:
            listener_kb.join() # Ждем завершения слушателя клавиатуры
            listener_mouse.join() # Ждем завершения слушателя мыши
    ```

**Особенности и замечания:**
*   `pynput` также работает кроссплатформенно, но для Linux может потребоваться установка `python3-xlib`.
*   Библиотека позволяет создавать как контроллеры (для отправки ввода), так и слушатели (для приема ввода).
*   Слушатели работают в отдельных потоках, что позволяет вашему основному приложению продолжать работу.
*   **Безопасность/Разрешения:** На некоторых системах (особенно с Wayland вместо Xorg) может потребоваться предоставить дополнительные разрешения для работы с глобальными слушателями или контролем ввода. Для `pynput` на Wayland может потребоваться настройка, так как прямое взаимодействие с этим протоколом сложнее, чем с Xorg.

### В заключение:

*   Используйте **`PyAutoGUI`**, если вам нужен быстрый и простой способ автоматизировать действия пользователя, имитировать ввод и делать скриншоты. Он отлично подходит для высокоуровневых скриптов автоматизации.
*   Используйте **`pynput`**, если вам нужен более тонкий контроль над вводом, возможность слушать события мыши и клавиатуры на глобальном уровне, или если вы хотите создать более сложные и отзывчивые системы автоматизации.

Обе библиотеки очень мощные, но всегда будьте осторожны при их использовании, так как некорректно написанный скрипт может привести к нежелательным действиям на вашем компьютере. Всегда тестируйте скрипты в контролируемой среде!

Есть ли конкретная задача, которую вы хотели бы решить, используя одну из этих библиотек?