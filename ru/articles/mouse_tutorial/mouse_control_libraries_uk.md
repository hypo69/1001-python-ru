# Керування мишею в Python: Огляд та порівняння бібліотек

Автоматизація дій миші є потужним інструментом для тестування, наукових досліджень, бізнес-процесів та створення допоміжних технологій. В екосистемі Python існує кілька бібліотек для цих цілей, кожна з яких має свої сильні сторони та сценарії застосування. У цій статті ми детально розглянемо три основні кросплатформні бібліотеки: `PyAutoGUI`, `pynput` та `mouse`, а також коротко згадаємо інші спеціалізовані рішення.

## 1. Бібліотека PyAutoGUI: Високорівнева автоматизація GUI

`PyAutoGUI` — це потужна та проста у використанні кросплатформна бібліотека, яка дозволяє Python-скриптам керувати мишею та клавіатурою, робити знімки екрана та виконувати інші завдання автоматизації графічного інтерфейсу користувача (GUI). Вона ідеально підходить для автоматизації рутинних завдань, тестування програмного забезпечення та створення ботів. **Підтримує Windows, macOS та Linux.**

### Встановлення

```bash
pip install pyautogui
```

### Ключові можливості

*   **Переміщення курсору**: `pyautogui.moveTo(x, y, duration=seconds)` для абсолютного переміщення та `pyautogui.move(xOffset, yOffset, duration=seconds)` для відносного переміщення.
*   **Клацання миші**: `pyautogui.click()`, `pyautogui.rightClick()`, `pyautogui.doubleClick()`, `pyautogui.tripleClick()`. Можна вказати координати та кнопку.
*   **Перетягування (Drag and Drop)**: `pyautogui.dragTo(x, y, duration=seconds)` або `pyautogui.drag(xOffset, yOffset, duration=seconds)`.
*   **Прокрутка колеса миші**: `pyautogui.scroll(amount)` (позитивне значення прокручує вгору, негативне — вниз).
*   **Взаємодія з клавіатурою**: `pyautogui.write()`, `pyautogui.press()`, `pyautogui.hotkey()`.
*   **Отримання позиції курсору**: `pyautogui.position()`.
*   **Failsafe**: Вбудована функція безпеки, яка зупиняє скрипт, коли курсор миші переміщується в один із чотирьох кутів екрана.

### Приклади використання

```python
import pyautogui
import time

# Переміщення курсору
pyautogui.moveTo(100, 150, duration=1)
print(f"Курсор переміщено до {pyautogui.position()}")

# Ліве клацання
pyautogui.click(200, 250)
print("Клацання виконано.")

# Перетягування
pyautogui.moveTo(500, 500, duration=0.5)
pyautogui.dragTo(600, 600, duration=1)
print("Перетягування виконано.")

# Прокрутка колеса
pyautogui.scroll(-100)
print("Прокручено вниз.")

# Введення тексту
pyautogui.write('Привіт, PyAutoGUI!', interval=0.1)
print("Текст введено.")
```

### Коли використовувати PyAutoGUI?

✅ Ідеально підходить, якщо вам потрібен швидкий і простий спосіб автоматизувати дії користувача, імітувати введення та робити знімки екрана. Він чудово підходить для високорівневих скриптів автоматизації, де не потрібен детальний контроль над подіями введення.

❌ Не найкращий вибір для низькорівневого моніторингу подій або блокування введення.

## 2. Бібліотека pynput: Гнучке керування та моніторинг

`pynput` — це сучасний, активно підтримуваний інструмент для комплексного моніторингу та керування пристроями введення. Він надає детальний доступ до подій миші та клавіатури, включаючи можливість блокувати або модифікувати їх у реальному часі. **Підтримує Windows, macOS та Linux.**

### Встановлення

```bash
pip install pynput
```

### Ключові можливості

*   **Повноцінні слухачі подій**: `pynput.mouse.Listener` дозволяє відстежувати рухи, клацання та прокрутку з доступом до координат, типу кнопки та стану (натиснута/відпущена).
*   **Блокування подій**: Якщо обробник події повертає `False`, подія не передається далі системі. Це унікальна та потужна функція.
*   **Керування мишею через контролер**: `pynput.mouse.Controller` для емуляції дій (позиціонування, відносне переміщення, клацання, прокрутка).
*   **Уніфікована архітектура клавіатури**: Легко комбінувати дії миші та клавіатури.
*   **Безпека потоків**: Слухачі працюють в окремих потоках, забезпечуючи гнучке керування.

### Приклади використання

```python
from pynput import mouse
from pynput.mouse import Controller, Button
import time

# Керування мишею
mouse_ctrl = Controller()
print(f"Поточна позиція: {mouse_ctrl.position}")
mouse_ctrl.position = (100, 200)
mouse_ctrl.move(50, -50)
mouse_ctrl.click(Button.left, 1)
mouse_ctrl.scroll(0, 2)
print("Дії миші виконано.")

# Слухач подій
def on_click(x, y, button, pressed):
    print(f"Клацання в ({x}, {y}) кнопкою {button}. Натиснуто: {pressed}")
    if not pressed:
        # Зупинити слухача після відпускання кнопки
        return False

listener = mouse.Listener(on_click=on_click)
listener.start()
print("Слухач активний. Клацніть мишею.")
listener.join() # Чекаємо завершення слухача
print("Слухач завершено.")
```

### Коли використовувати pynput?

✅ Ідеально підходить, якщо ви:
- Потребуєте **аналізу поведінки користувача** (координати, траєкторії, частота клацань).
- Створюєте **системи гарячих клавіш**, **фільтри введення** або **допоміжні технології**.
- Хочете **блокувати або модифікувати введення** в реальному часі.
- Проводите **науковий експеримент**, **тестування зручності використання** або **систему безпеки**.
- Потрібна **інтеграція миші та клавіатури** в одному скрипті.

❌ Не найшвидший вибір, якщо вам потрібно просто записати та відтворити дії без аналізу.

## 3. Бібліотека mouse: Простота та запис дій

Бібліотека `mouse` — це мінімалістичний, але ефективний інструмент для емуляції та запису послідовностей дій миші. Її головна «фішка» — вбудована підтримка запису та відтворення, що робить її ідеальною для швидкого прототипування макросів. **Підтримує Windows, macOS та Linux.**

### Встановлення

```bash
pip install mouse
```

### Ключові можливості

*   **Переміщення курсору**: `mouse.move(x, y, absolute=True/False)`.
*   **Клацання миші**: `mouse.click('left'/'right'/'middle')`.
*   **Перетягування**: `mouse.drag(x1, y1, x2, y2, absolute=True)`.
*   **Колесо прокрутки**: `mouse.wheel(delta)`.
*   **Отримання позиції курсору**: `mouse.get_position()`.
*   **Перевірка стану кнопки**: `mouse.is_pressed(button)`.
*   **Запис та відтворення подій**: `mouse.record()` та `mouse.play()`. Це унікальна вбудована функція.
*   **Простий обробник клацань**: `mouse.on_click(handler)`.

### Приклади використання

```python
import mouse
import time

# Переміщення та клацання
mouse.move(200, 300, absolute=True, duration=0.2)
mouse.click('left')
print("Переміщення та клацання виконано.")

# Запис та відтворення (потребує інтерактивного введення)
print("Почніть запис. Натисніть праву кнопку, щоб зупинити.")
# events = mouse.record()
# print("Запис завершено. Відтворення...")
# mouse.play(events[:-1]) # Відтворюємо всі, крім останньої події (відпускання правої кнопки)
# print("Відтворення завершено.")

# Прокрутка
mouse.wheel(-2)
print("Прокручено вниз.")
```

### Коли використовувати mouse?

✅ Ідеально для:
- Запису та повторного виконання рутинних дій.
- Простих скриптів автоматизації без зворотного зв'язку.
- Навчальних прикладів та демонстрацій, де важлива максимальна простота.

❌ Не підходить для:
- Аналізу поведінки користувача (обробники не отримують координати).
- Створення фільтрів або блокувальників введення.
- Інтеграції з клавіатурою.
- Проект не оновлювався з 2021 року, що може бути ризиком для довгострокових проектів.

## 4. Інші помітні бібліотеки

Хоча `PyAutoGUI`, `pynput` та `mouse` є найбільш універсальними, існують й інші бібліотеки для більш специфічних завдань:

*   **PyDirectInput**: Спеціалізована бібліотека, розроблена як альтернатива `PyAutoGUI` для автоматизації ігор. Вона може обходити проблеми, коли деякі ігри можуть не реєструвати введення від `PyAutoGUI` через їхні специфічні механізми обробки введення.
*   **pywinauto**: Орієнтована на автоматизацію інтерфейсу користувача Windows. Вона взаємодіє з елементами керування Windows, використовуючи фреймворки доступності та UI Automation, що робить її надійним вибором для автоматизації нативних програм Windows шляхом націлювання на елементи, а не на екранні координати.

## 5. Порівняльна таблиця

| Можливість / Бібліотека | PyAutoGUI | pynput | mouse |
|-------------------------|:---------:|:------:|:-----:|
| **Підтримувані ОС**     | Windows, macOS, Linux | Windows, macOS, Linux | Windows, macOS, Linux |
|-------------------------|:---------:|:------:|:-----:|
| **Встановлення**        | `pip install pyautogui` | `pip install pynput` | `pip install mouse` |
| **Переміщення курсору** | ✅ Абс./Відн. | ✅ Абс./Відн. | ✅ Абс./Відн. |
| **Клацання миші**       | ✅ Всі типи | ✅ Всі типи | ✅ Всі типи |
| **Перетягування**       | ✅ `dragTo()` | ⚠️ Вручну | ✅ `drag()` |
| **Прокрутка колеса**    | ✅ Так      | ✅ Так   | ✅ Так  |
| **Отримання позиції**   | ✅ Так      | ✅ Так   | ✅ Так  |
| **Перевірка стану кнопки** | ❌ Ні       | ⚠️ Через Listener | ✅ Так  |
| **Запис/Відтворення**   | ❌ Ні       | ❌ Ні (тільки вручну) | ✅ Вбудовано |
| **Координати в обробнику** | ❌ Ні       | ✅ Так   | ❌ Ні   |
| **Блокування подій**    | ❌ Ні       | ✅ Так (`return False`) | ❌ Ні   |
| **Інтеграція з клавіатурою** | ✅ Так      | ✅ Так   | ❌ Ні   |
| **Активна підтримка**  | ✅ Так      | ✅ Так   | ❌ Ні (з 2021) |
| **Failsafe**            | ✅ Так      | ❌ Ні    | ❌ Ні   |
| **Складність API**      | Середня     | Середня/Висока | Низька |

## Висновок

Вибір бібліотеки для керування мишею в Python залежить від ваших конкретних потреб:

*   **PyAutoGUI**: Ваш вибір за замовчуванням для високорівневої автоматизації GUI, коли вам потрібно імітувати дії користувача, включаючи клавіатуру та знімки екрана, без глибокого аналізу подій.
*   **pynput**: Ідеальний для проектів, що вимагають детального контролю над подіями миші (та клавіатури), моніторингу, аналізу, а також можливості блокувати або модифікувати введення в реальному часі. Це професійний інструмент для складних систем.
*   **mouse**: Найкраще підходить для простих завдань запису та відтворення макросів, де важлива максимальна простота та мінімальний код. Однак варто враховувати відсутність активної підтримки.

Для нових проектів, що вимагають гнучкості та довгострокової підтримки, рекомендується `pynput`. Якщо ж ваше завдання — швидка автоматизація рутинних дій, `PyAutoGUI` буде чудовим вибором.
