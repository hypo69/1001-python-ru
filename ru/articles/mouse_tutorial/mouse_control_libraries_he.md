# שליטה בעכבר בפייתון: סקירה והשוואת ספריות

אוטומציה של פעולות עכבר היא כלי רב עוצמה לבדיקות, מחקר מדעי, תהליכים עסקיים ויצירת טכנולוגיות מסייעות. בתוך אקוסיסטם הפייתון, קיימות מספר ספריות למטרות אלו, כל אחת עם החוזקות ותחומי השימוש שלה. במאמר זה, נבחן בפירוט שלוש ספריות עיקריות חוצות פלטפורמות: `PyAutoGUI`, `pynput` ו-`mouse`, וכן נזכיר בקצרה פתרונות מיוחדים אחרים.

## 1. ספריית PyAutoGUI: אוטומציית GUI ברמה גבוהה

`PyAutoGUI` היא ספרייה חוצת פלטפורמות חזקה וקלה לשימוש המאפשרת לסקריפטים בפייתון לשלוט בעכבר ובמקלדת, לצלם צילומי מסך ולבצע משימות אוטומציה אחרות של ממשק משתמש גרפי (GUI). היא אידיאלית לאוטומציה של משימות שגרתיות, בדיקות תוכנה ויצירת בוטים. **תומכת ב-Windows, macOS ו-Linux.**

### התקנה

```bash
pip install pyautogui
```

### תכונות עיקריות

*   **תנועת סמן**: `pyautogui.moveTo(x, y, duration=seconds)` לתנועה מוחלטת ו-`pyautogui.move(xOffset, yOffset, duration=seconds)` לתנועה יחסית.
*   **לחיצות עכבר**: `pyautogui.click()`, `pyautogui.rightClick()`, `pyautogui.doubleClick()`, `pyautogui.tripleClick()`. ניתן לציין קואורדינטות וכפתור.
*   **גרירה ושחרור (Drag and Drop)**: `pyautogui.dragTo(x, y, duration=seconds)` או `pyautogui.drag(xOffset, yOffset, duration=seconds)`.
*   **גלילת גלגלת העכבר**: `pyautogui.scroll(amount)` (ערך חיובי גולל למעלה, שלילי גולל למטה).
*   **אינטראקציה עם מקלדת**: `pyautogui.write()`, `pyautogui.press()`, `pyautogui.hotkey()`.
*   **קבלת מיקום סמן**: `pyautogui.position()`.
*   **Failsafe**: תכונת בטיחות מובנית העוצרת את הסקריפט כאשר סמן העכבר מוזז לאחת מארבע פינות המסך.

### דוגמאות שימוש

```python
import pyautogui
import time

# הזזת סמן
pyautogui.moveTo(100, 150, duration=1)
print(f"הסמן הוזז ל- {pyautogui.position()}")

# לחיצה שמאלית
pyautogui.click(200, 250)
print("לחיצה בוצעה.")

# גרירה
pyautogui.moveTo(500, 500, duration=0.5)
pyautogui.dragTo(600, 600, duration=1)
print("גרירה בוצעה.")

# גלילת גלגלת
pyautogui.scroll(-100)
print("גלילה למטה בוצעה.")

# הקלדת טקסט
pyautogui.write('שלום, PyAutoGUI!', interval=0.1)
print("טקסט הוזן.")
```

### מתי להשתמש ב-PyAutoGUI?

✅ אידיאלי אם אתם זקוקים לדרך מהירה וקלה לאוטומציה של פעולות משתמש, דימוי קלט וצילום מסך. היא מצוינת לסקריפטים של אוטומציה ברמה גבוהה שבהם אין צורך בשליטה מפורטת על אירועי קלט.

❌ לא הבחירה הטובה ביותר לניטור אירועים ברמה נמוכה או חסימת קלט.

## 2. ספריית pynput: שליטה וניטור גמישים

`pynput` הוא כלי מודרני, הנתמך באופן פעיל, לניטור ובקרה מקיפים של התקני קלט. הוא מספק גישה מפורטת לאירועי עכבר ומקלדת, כולל היכולת לחסום או לשנות אותם בזמן אמת. **תומכת ב-Windows, macOS ו-Linux.**

### התקנה

```bash
pip install pynput
```

### תכונות עיקריות

*   **מאזיני אירועים מקיפים**: `pynput.mouse.Listener` מאפשר מעקב אחר תנועות, לחיצות וגלילה עם גישה לקואורדינטות, סוג הכפתור ומצב (לחוץ/משוחרר).
*   **חסימת אירועים**: אם מטפל אירועים מחזיר `False`, האירוע אינו מועבר הלאה למערכת. זוהי תכונה ייחודית וחזקה.
*   **שליטה בעכבר באמצעות בקר**: `pynput.mouse.Controller` לדימוי פעולות (מיקום, תנועה יחסית, לחיצות, גלילה).
*   **ארכיטקטורת מקלדת מאוחדת**: שילוב קל של פעולות עכבר ומקלדת.
*   **בטיחות תהליכים (Thread Safety)**: מאזינים פועלים בתהליכים נפרדים, ומספקים ניהול גמיש.

### דוגמאות שימוש

```python
from pynput import mouse
from pynput.mouse import Controller, Button
import time

# שליטה בעכבר
mouse_ctrl = Controller()
print(f"מיקום נוכחי: {mouse_ctrl.position}")
mouse_ctrl.position = (100, 200)
mouse_ctrl.move(50, -50)
mouse_ctrl.click(Button.left, 1)
mouse_ctrl.scroll(0, 2)
print("פעולות עכבר בוצעו.")

# מאזין אירועים
def on_click(x, y, button, pressed):
    print(f"לחיצה ב- ({x}, {y}) עם כפתור {button}. לחוץ: {pressed}")
    if not pressed:
        # עצור מאזין לאחר שחרור כפתור
        return False

listener = mouse.Listener(on_click=on_click)
listener.start()
print("מאזין פעיל. לחץ על העכבר.")
listener.join() # המתן לסיום המאזין
print("מאזין הסתיים.")
```

### מתי להשתמש ב-pynput?

✅ אידיאלי אם אתם:
- זקוקים ל**ניתוח התנהגות משתמש** (קואורדינטות, מסלולים, תדירות לחיצות).
- יוצרים **מערכות מקשי קיצור**, **מסנני קלט** או **טכנולוגיות מסייעות**.
- רוצים **לחסום או לשנות קלט** בזמן אמת.
- עורכים **ניסוי מדעי**, **בדיקות שימושיות** או **מערכת אבטחה**.
- נדרשת **אינטגרציה של עכבר ומקלדת** בסקריפט יחיד.

❌ לא הבחירה המהירה ביותר אם אתם רק צריכים להקליט ולהפעיל מחדש פעולות ללא ניתוח.

## 3. ספריית mouse: פשטות והקלטת פעולות

ספריית `mouse` היא כלי מינימליסטי אך יעיל לדימוי והקלטת רצפים של פעולות עכבר. התכונה העיקרית שלה היא תמיכה מובנית בהקלטה והפעלה, מה שהופך אותה לאידיאלית ליצירת אבות טיפוס מהירה של פקודות מאקרו. **תומכת ב-Windows, macOS ו-Linux.**

### התקנה

```bash
pip install mouse
```

### תכונות עיקריות

*   **תנועת סמן**: `mouse.move(x, y, absolute=True/False)`.
*   **לחיצות עכבר**: `mouse.click('left'/'right'/'middle')`.
*   **גרירה ושחרור**: `mouse.drag(x1, y1, x2, y2, absolute=True)`.
*   **גלגלת גלילה**: `mouse.wheel(delta)`.
*   **קבלת מיקום סמן**: `mouse.get_position()`.
*   **בדיקת מצב כפתור**: `mouse.is_pressed(button)`.
*   **הקלטה והפעלה של אירועים**: `mouse.record()` ו-`mouse.play()`. זוהי פונקציה מובנית ייחודית.
*   **מטפל לחיצות פשוט**: `mouse.on_click(handler)`.

### דוגמאות שימוש

```python
import mouse
import time

# הזזה ולחיצה
mouse.move(200, 300, absolute=True, duration=0.2)
mouse.click('left')
print("הזזה ולחיצה בוצעו.")

# הקלטה והפעלה (דורש קלט אינטראקטיבי)
print("התחל הקלטה. לחץ על כפתור ימני כדי לעצור.")
# events = mouse.record()
# print("הקלטה הסתיימה. מנגן...")
# mouse.play(events[:-1]) # מנגן הכל מלבד האירוע האחרון (שחרור כפתור ימני)
# print("הפעלה הסתיימה.")

# גלילה
mouse.wheel(-2)
print("גלילה למטה בוצעה.")
```

### מתי להשתמש ב-mouse?

✅ אידיאלי עבור:
- הקלטה והפעלה מחדש של פעולות שגרתיות.
- סקריפטים פשוטים לאוטומציה ללא משוב.
- דוגמאות והדגמות חינוכיות שבהן פשטות מרבית היא המפתח.

❌ לא מתאים עבור:
- ניתוח התנהגות משתמש (מטפלים אינם מקבלים קואורדינטות).
- יצירת מסנני קלט או חוסמים.
- שילוב מקלדת.
- הפרויקט לא עודכן מאז 2021, מה שעשוי להוות סיכון לפרויקטים ארוכי טווח.

## 4. ספריות בולטות אחרות

בעוד ש-`PyAutoGUI`, `pynput` ו-`mouse` הן הרב-גוניות ביותר, קיימות ספריות אחרות למשימות ספציפיות יותר:

*   **PyDirectInput**: ספרייה מיוחדת שתוכננה כחלופה ל-`PyAutoGUI` לאוטומציה של משחקים. היא יכולה לעקוף בעיות שבהן משחקים מסוימים עשויים שלא לרשום קלט מ-`PyAutoGUI` עקב מנגנוני הטיפול בקלט הספציפיים שלהם.
*   **pywinauto**: מתמקדת באוטומציה של ממשק המשתמש של Windows. היא מקיימת אינטראקציה עם פקדי Windows באמצעות מסגרות נגישות ואוטומציית ממשק משתמש, מה שהופך אותה לבחירה אמינה לאוטומציה של יישומי Windows מקוריים על ידי מיקוד אלמנטים במקום קואורדינטות מסך.

## 5. טבלת השוואה

| תכונה / ספרייה           | PyAutoGUI | pynput | mouse |
|--------------------------|:---------:|:------:|:-----:|
| **תמיכה במערכות הפעלה**  | Windows, macOS, Linux | Windows, macOS, Linux | Windows, macOS, Linux |
| **התקנה**                | `pip install pyautogui` | `pip install pynput` | `pip install mouse` |
| **תנועת סמן**            | ✅ מוחלט/יחסי | ✅ מוחלט/יחסי | ✅ מוחלט/יחסי |
| **לחיצות עכבר**          | ✅ כל הסוגים | ✅ כל הסוגים | ✅ כל הסוגים |
| **גרירה ושחרור**         | ✅ `dragTo()` | ⚠️ ידני | ✅ `drag()` |
| **גלגלת גלילה**          | ✅ כן       | ✅ כן    | ✅ כן   |
| **קבלת מיקום**           | ✅ כן       | ✅ כן    | ✅ כן   |
| **בדיקת מצב כפתור**      | ❌ לא       | ⚠️ דרך Listener | ✅ כן   |
| **הקלטה/הפעלה**          | ❌ לא       | ❌ לא (ידני בלבד) | ✅ מובנה |
| **קואורדינטות במטפל**    | ❌ לא       | ✅ כן    | ❌ לא   |
| **חסימת אירועים**        | ❌ לא       | ✅ כן (`return False`) | ❌ לא   |
| **שילוב מקלדת**          | ✅ כן       | ✅ כן    | ❌ לא   |
| **תמיכה פעילה**          | ✅ כן       | ✅ כן    | ❌ לא (מאז 2021) |
| **Failsafe**             | ✅ כן       | ❌ לא    | ❌ לא   |
| **מורכבות API**          | בינונית    | בינונית/גבוהה | נמוכה   |

## מסקנה

בחירת ספריית שליטה בעכבר בפייתון תלויה בצרכים הספציפיים שלכם:

*   **PyAutoGUI**: הבחירה המוגדרת כברירת מחדל לאוטומציית GUI ברמה גבוהה כאשר אתם צריכים לדמות פעולות משתמש, כולל מקלדת וצילומי מסך, ללא ניתוח אירועים מעמיק.
*   **pynput**: אידיאלי לפרויקטים הדורשים שליטה מדויקת על אירועי עכבר (ומקלדת), ניטור, ניתוח, וכן היכולת לחסום או לשנות קלט בזמן אמת. זהו כלי מקצועי למערכות מורכבות.
*   **mouse**: מתאים ביותר למשימות פשוטות של הקלטת והפעלת פקודות מאקרו, שבהן פשטות מרבית וקוד מינימלי חשובים. עם זאת, יש לקחת בחשבון את היעדר התמיכה הפעילה.

לפרויקטים חדשים הדורשים גמישות ותמיכה לטווח ארוך, מומלץ `pynput`. אם המשימה שלכם היא אוטומציה מהירה של פעולות שגרתיות, `PyAutoGUI` תהיה בחירה מצוינת.