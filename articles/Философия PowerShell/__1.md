Microsoft –¥–æ PowerShell.


–ö –º–æ–º–µ–Ω—Ç—É –≤—ã—Ö–æ–¥–∞ MS DOS –Ω–∞ —Ä—ã–Ω–∫–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª —Å—Ç–∞–Ω–¥–∞—Ä—Ç POSIX, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –≤  



 1. MS-DOS –∏ COMMAND.COM (1981)
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å DOS –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–ª –æ–¥–∏–Ω —Ñ–∞–π–ª command.com —Å —Å–∫—É–¥–Ω—ã–º  –Ω–∞–±–æ—Ä–æ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∫–æ–º–∞–Ω–¥ (dir, copy, del –∏ —Ç.p.). 
```bash
```
–ë—ã–ª–∏ –≤–Ω–µ—à–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã (.exe –∏–ª–∏ .com). –ü—Ä–∏–º–µ—Ä—ã: FORMAT.COM, XCOPY.EXE, CHKDSK.EXE, EDIT.COM.
–°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å—ã–≤–∞–ª–∏—Å—å –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .bat (batch file)


- AUTOEXEC.BAT

```bash
:: ------------------------------------------------------------------------------
:: AUTOEXEC.BAT ‚Äî –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫ Windows 3.11
:: –ê–≤—Ç–æ—Ä: hypo69
:: –ì–æ–¥: –ø—Ä–∏–º–µ—Ä–Ω–æ 1993
:: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –í—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é DOS-—Å—Ä–µ–¥—ã, –∑–∞–≥—Ä—É–∑–∫—É —Å–µ—Ç–µ–≤—ã—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –∏ –∑–∞–ø—É—Å–∫ Windows 3.11
:: ------------------------------------------------------------------------------
@ECHO OFF

:: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
PROMPT $p$g

:: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã
SET TEMP=C:\TEMP
PATH=C:\DOS;C:\WINDOWS

:: –ó–∞–≥—Ä—É–∑–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –∏ —É—Ç–∏–ª–∏—Ç –≤ –≤–µ—Ä—Ö–Ω—é—é –ø–∞–º—è—Ç—å
LH C:\DOS\SMARTDRV.EXE       :: –î–∏—Å–∫–æ–≤—ã–π –∫—ç—à
LH C:\DOS\MOUSE.COM          :: –î—Ä–∞–π–≤–µ—Ä –º—ã—à–∏

:: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö —Å–ª—É–∂–± (–∞–∫—Ç—É–∞–ª—å–Ω–æ –¥–ª—è Windows for Workgroups 3.11)
IF EXIST C:\NET\NET.EXE LH C:\NET\NET START

:: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ Windows
WIN

```
- CONFIG.SYS
```bash
:: ------------------------------------------------------------------------------
:: CONFIG.SYS ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ –∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ DOS –¥–ª—è Windows 3.11
:: –ê–≤—Ç–æ—Ä: hypo69
:: –ì–æ–¥: –ø—Ä–∏–º–µ—Ä–Ω–æ 1993
:: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –ø–∞–º—è—Ç–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
:: ------------------------------------------------------------------------------
DEVICE=C:\DOS\HIMEM.SYS
DEVICE=C:\DOS\EMM386.EXE NOEMS
DOS=HIGH,UMB
FILES=40
BUFFERS=30
DEVICEHIGH=C:\DOS\SETVER.EXE

```


–ù–∞ —Ç–æ—Ç –º–æ–º–µ–Ω—Ç DOS –±—ã–ª–∞ —á—É—Ç—å –ª–∏ –Ω–µ –µ–¥–∏–Ω—Å—Ç–≤–µ—Ä–Ω–Ω–æ–π POSIX - –ù–ï —Å–æ–≤–º–µ—Å—Ç–∏–æ–º–æ–π –æ—Å –±–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ sh. 



–°–ø–∏—Å–æ–∫ —Å–∏—Å—Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –≤ 1993 –≥–æ–¥—É –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª–∏ Bourne shell (sh), Bash, C shell (csh), –∏ –¥—Ä.:

| –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞         | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `sh` / `bash` / `csh` –∏ —Ç.–ø. | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ                   |
| ---------------------------- | -------------------------------------- | ---------------------------- |
| **AT\&T UNIX System V (R4)** | `sh`, `ksh`, `csh`                     | –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π UNIX            |
| **SunOS 4.x / Solaris 2.1**  | `sh`, `csh`, `ksh`, –ø–æ–∑–∂–µ `bash`       | Solaris 2.1 ‚Äî –Ω–∞ –±–∞–∑–µ SVR4   |
| **BSD (4.3BSD, 4.4BSD)**     | `sh`, `csh`, `tcsh`                    | –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—Å–∫–∞—è –≤–µ—Ç–∫–∞ UNIX   |
| **AIX (IBM)**                | `sh`, `ksh`, `csh`, `tcsh`             | UNIX –æ—Ç IBM                  |
| **HP-UX (Hewlett-Packard)**  | `sh`, `ksh`                            | –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π UNIX            |
| **IRIX (Silicon Graphics)**  | `sh`, `csh`                            | SGI UNIX                     |
| **SCO UNIX**                 | `sh`, `ksh`                            | UNIX –Ω–∞ –±–∞–∑–µ System V        |
| **MINIX 1.x**                | `sh`                                   | –£—á–µ–±–Ω–∞—è –û–°, –≤–¥–æ—Ö–Ω–æ–≤–∏–ª–∞ Linux |


–î–æ –ø–æ—è–≤–ª–µ–Ω–∏—è **PowerShell** (–≤ 2006 –≥–æ–¥—É), Microsoft –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ —Ä–∞–∑–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è, –Ω–∞—á–∏–Ω–∞—è —Å **MS-DOS** –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—è **Windows Server 2003**. –í—Å—ë —ç—Ç–æ –±—ã–ª–æ **—Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã–º**, —á–∞—Å—Ç–æ GUI-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ –Ω–µ –≤—Å–µ–≥–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ–º—ã–º. 
---


#### üìå –°–ø–∏—Å–æ–∫ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:

| –°—Ä–µ–¥—Å—Ç–≤–æ                      | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                      |
| ----------------------------- | --------------------------------------------------------------- |
| `cmd.exe`                     | –£–ª—É—á—à–µ–Ω–Ω—ã–π –∫–æ–º–∞–Ω–¥–Ω—ã–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä (–∑–∞–º–µ–Ω–∞ `COMMAND.COM`)       |
| `.bat`, `.cmd`                | –°–∫—Ä–∏–ø—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏                                        |
| **Windows Script Host (WSH)** | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ VBScript –∏ JScript –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏                  |
| `reg.exe`                     | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–æ–º –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏                         |
| `net.exe`                     | –†–∞–±–æ—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, —Å–µ—Ç—å—é, –ø—Ä–∏–Ω—Ç–µ—Ä–∞–º–∏                      |
| `sc.exe`                      | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±–∞–º–∏                                             |
| `tasklist`, `taskkill`        | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏                                           |
| `gpedit.msc`                  | –ì—Ä—É–ø–ø–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ (–ª–æ–∫–∞–ª—å–Ω–æ)                                   |
| `MMC`                         | –ö–æ–Ω—Å–æ–ª—å —Å–æ —Å–Ω–∞–ø-–∏–Ω–∞–º–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è                            |
| `WMI`                         | –î–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (—á–µ—Ä–µ–∑ `wmic`, VBScript, –∏–ª–∏ COM) |
| `WbemTest.exe`                | GUI –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è WMI-–∑–∞–ø—Ä–æ—Å–æ–≤                               |
| `eventvwr`                    | –ü—Ä–æ—Å–º–æ—Ç—Ä –∂—É—Ä–Ω–∞–ª–æ–≤ —Å–æ–±—ã—Ç–∏–π                                       |
| `perfmon`                     | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤                                             |

#### üõ† –ü—Ä–∏–º–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏:

* VBScript-—Ñ–∞–π–ª—ã (`*.vbs`) –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–µ—Ç–µ–π, –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ –∏ —Å–ª—É–∂–±.
* `WMIC` ‚Äî –∫–æ–º–∞–Ω–¥–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫ WMI (–Ω–∞–ø—Ä–∏–º–µ—Ä: `wmic process list brief`).
* `.cmd` —Å–∫—Ä–∏–ø—Ç—ã —Å –≤—ã–∑–æ–≤–∞–º–∏ `net`, `sc`, `reg`, `wmic`, –∏ —Ç.–¥.

---

## ‚öôÔ∏è Windows Scripting Host (WSH)

* –í–ø–µ—Ä–≤—ã–µ –ø–æ—è–≤–∏–ª—Å—è –≤ **Windows 98**, –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –≤ **Windows 2000 –∏ XP**.
* –ü–æ–∑–≤–æ–ª—è–ª –≤—ã–ø–æ–ª–Ω—è—Ç—å VBScript –∏ JScript-—Ñ–∞–π–ª—ã –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:

  ```vbscript
  Set objShell = WScript.CreateObject("WScript.Shell")
  objShell.Run "notepad.exe"
  ```

---

## üß© –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –¥–æ PowerShell

* –°–∫—Ä–∏–ø—Ç—ã `.bat` ‚Äî **–æ—á–µ–Ω—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ** –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º.
* –ù–µ—Ç —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º –æ–±—ä–µ–∫—Ç–∞–º (—Å–æ–±—ã—Ç–∏—è, –ø—Ä–æ—Ü–µ—Å—Å—ã, —Å–ª—É–∂–±—ã, COM).
* WMI –º–æ—â–Ω—ã–π, –Ω–æ –Ω–µ—É–¥–æ–±–Ω—ã–π –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏.
* –†–∞–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á (`net`, `sc`, `reg`, `wmic`), –±–µ–∑ –æ–±—â–µ–π –ª–æ–≥–∏–∫–∏.

---

## üöÄ –ü–æ—è–≤–ª–µ–Ω–∏–µ PowerShell (2006)

PowerShell —Ä–µ—à–∏–ª –≤—Å–µ –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

* –û–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±–æ–ª–æ—á–∫–∞ (–Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç).
* –ï–¥–∏–Ω–∞—è –ª–æ–≥–∏–∫–∞: `Get-`, `Set-`, `Remove-`, `Start-` –∏ —Ç.–¥.
* –ì–ª—É–±–æ–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å WMI, COM, .NET, Active Directory.
* –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å: –º–æ–¥—É–ª–∏, —Å–Ω–∞–ø–∏–Ω—ã, —É–¥–∞–ª—ë–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (WinRM).

