<p><a href="https://habr.com/ru/articles/667008/">https://habr.com/ru/articles/667008/</a></p>
<p>Ottimo! Ecco un tutorial dettagliato basato sul tuo articolo. L'ho trasformato in una guida strutturata passo-passo con spiegazioni e consigli per ogni fase dello sviluppo di un chatbot autoapprendente in Python con la possibilit√† di cercare informazioni su Wikipedia.</p>
<hr>
<h2>üß† Chatbot autoapprendente in Python con ricerca Wikipedia e integrazione Telegram</h2>
<h2>üéØ Obiettivo</h2>
<p>Imparare a creare un bot Telegram in Python che:</p>
<ul>
<li>Comprende le domande dell'utente e risponde ad esse utilizzando un semplice machine learning.</li>
<li>√à in grado di cercare informazioni su Wikipedia in russo.</li>
<li>Autoapprendimento: pu√≤ memorizzare le risposte corrette che l'utente gli suggerisce.</li>
</ul>
<hr>
<h2>üß∞ Passaggio 1. Installazione delle librerie necessarie</h2>
<p>Avremo bisogno delle seguenti librerie:</p>
<ul>
<li><strong>pyTelegramBotAPI</strong> ‚Äî per l'interazione con Telegram.</li>
<li><strong>scikit-learn</strong> ‚Äî per il machine learning.</li>
<li><strong>wikipedia</strong> ‚Äî per la ricerca di informazioni su Wikipedia.</li>
</ul>
<p>Installale con il comando:</p>
<pre class="line-numbers"><code class="language-bash">pip install pyTelegramBotAPI wikipedia scikit-learn
</code></pre>
<hr>
<h2>üõ† Passaggio 2. Configurazione dellambiente</h2>
<p>Crea un file Python (ad esempio <code>bot.py</code>) e incolla il seguente codice:</p>
<pre class="line-numbers"><code class="language-python">import telebot, wikipedia, re
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.linear_model import LogisticRegression
</code></pre>
<h3>Imposta la lingua di Wikipedia e crea il bot</h3>
<pre class="line-numbers"><code class="language-python">wikipedia.set_lang("ru")
bot = telebot.TeleBot('IL_TUO_TOKEN_DA_BOTFATHER')
</code></pre>
<p>Sostituisci <code>'IL_TUO_TOKEN_DA_BOTFATHER'</code> con il tuo token, ottenuto da <a href="https://t.me/botfather">BotFather</a> in Telegram.</p>
<hr>
<h2>‚úÇÔ∏è Passaggio 3. Pulizia del testo</h2>
<p>Il bot funzioner√† meglio se rimuoviamo i caratteri extra dal testo di input:</p>
<pre class="line-numbers"><code class="language-python">alphabet = ' 1234567890-–π—Ü—É–∫–µ–Ω–≥—à—â–∑—Ö—ä—Ñ—ã–≤–∞–ø—Ä–æ–ª–¥–∂—ç—è—á—Å–º–∏—Ç—å–±—é—ëqwertyuiopasdfghjklzxcvbnm?%.,()!:;'

def clean_str(r):
    r = r.lower()
    r = [c for c in r if c in alphabet]
    return ''.join(r)
</code></pre>
<hr>
<h2>üìÅ Passaggio 4. Preparazione dei dati di addestramento</h2>
<p>Crea un file <code>dialogues.txt</code> accanto a <code>bot.py</code>. Esempio di contenuto:</p>
<pre class="line-numbers">
ciao\ciao!
come stai\bene.
chi sei\sono Jarvis.
</pre>
<p>Formato: <strong>domanda\risposta</strong></p>
<hr>
<h2>ü§ñ Passaggio 5. Addestramento del modello</h2>
<p>Aggiungiamo una funzione che carica <code>dialogues.txt</code>, elabora i dati e addestra il modello:</p>
<pre class="line-numbers"><code class="language-python">def update():
    with open('dialogues.txt', encoding='utf-8') as f:
        content = f.read()

    blocks = content.strip().split('\n')
    dataset = []

    for block in blocks:
        replicas = block.split('\\')[:2]
        if len(replicas) == 2:
            pair = [clean_str(replicas[0]), clean_str(replicas[1])]
            if pair[0] and pair[1]:
                dataset.append(pair)

    X_text = [q for q, _ in dataset]
    y = [a for _, a in dataset]

    global vectorizer, clf
    vectorizer = CountVectorizer()
    X = vectorizer.fit_transform(X_text)

    clf = LogisticRegression()
    clf.fit(X, y)

update()
</code></pre>
<hr>
<h2>üí¨ Passaggio 6. Generazione delle risposte</h2>
<p>Una funzione che selezioner√† la migliore risposta in base al modello addestrato:</p>
<pre class="line-numbers"><code class="language-python">def get_generative_replica(text):
    text_vector = vectorizer.transform([clean_str(text)]).toarray()[0]
    return clf.predict([text_vector])[0]
</code></pre>
<hr>
<h2>üåê Passaggio 7. Ricerca su Wikipedia</h2>
<p>Il bot utilizzer√† Wikipedia se non trova una risposta adeguata:</p>
<pre class="line-numbers"><code class="language-python">def getwiki(s):
    try:
        page = wikipedia.page(s)
        text = page.content[:1000]
        sentences = text.split('.')[:-1]

        summary = ''
        for sentence in sentences:
            if '==' not in sentence and len(sentence.strip()) > 3:
                summary += sentence.strip() + '.'
            else:
                break

        summary = re.sub(r'\([^()]*\)', '', summary)
        summary = re.sub(r'\{[^\{\}]*\}', '', summary)
        return summary
    except Exception:
        return 'Nessuna informazione trovata su Wikipedia'
</code></pre>
<hr>
<h2>ü§ù Passaggio 8. Interazione con gli utenti</h2>
<p>Gestione dei comandi e dei messaggi degli utenti:</p>
<pre class="line-numbers"><code class="language-python">@bot.message_handler(commands=['start'])
def start_message(message):
    bot.send_message(message.chat.id, "Buongiorno, Signore.")

question = ""

@bot.message_handler(content_types=['text'])
def get_text_messages(message):
    global question
    command = message.text.lower()

    if command == "non cos√¨":
        bot.send_message(message.from_user.id, "e come?")
        bot.register_next_step_handler(message, wrong)
    else:
        question = command
        reply = get_generative_replica(command)
        if reply.strip() == "wiki":
            bot.send_message(message.from_user.id, getwiki(command))
        else:
            bot.send_message(message.from_user.id, reply)

def wrong(message):
    correction = message.text.lower()
    with open('dialogues.txt', "a", encoding='utf-8') as f:
        f.write(f"{question}\\{correction}\n")
    bot.send_message(message.from_user.id, "Fatto, ho memorizzato.")
    update()
</code></pre>
<hr>
<h2>‚ñ∂Ô∏è Passaggio 9. Avvio del bot</h2>
<p>Alla fine del file aggiungi:</p>
<pre class="line-numbers"><code class="language-python">bot.polling(none_stop=True)
</code></pre>
<p>Avvia il bot:</p>
<pre class="line-numbers"><code class="language-bash">python bot.py
</code></pre>
<hr>
<h2>üí° Consigli per il miglioramento</h2>
<ul>
<li>Usa modelli pi√π potenti, ad esempio <code>transformers</code>, per una comprensione avanzata del testo.</li>
<li>Aggiungi la registrazione degli errori.</li>
<li>Proteggi il token del bot tramite variabili d'ambiente (<code>os.environ.get(...)</code>).</li>
<li>Supporto per pi√π lingue e rilevamento della lingua.</li>
</ul>
<hr>
<h2>‚úÖ Cosa hai imparato</h2>
<ul>
<li>Come creare un bot Telegram in Python.</li>
<li>Come implementare un semplice machine learning con <code>scikit-learn</code>.</li>
<li>Come connettere Wikipedia e filtrare il suo contenuto.</li>
<li>Come creare un bot che autoapprende da nuovi dati.</li>
</ul>
<hr>
<p>Se necessario, posso formattarlo come PDF, guida HTML o post di blog. Vuoi continuare?</p>
