### Как проверить и исправить ошибки на жестком диске в Windows: шпаргалка по CHKDSK и PowerShell

Со временем на жестком диске или SSD могут накапливаться логические ошибки, появляться поврежденные сектора, что приводит к замедлению работы системы, сбоям программ и даже потере данных. К счастью, в Windows есть встроенные инструменты для диагностики и исправления таких проблем.

В этой шпаргалке я покажу два способа поддержания здоровья ваших дисков: утилиту `chkdsk` и команды PowerShell.

### Часть 1: Утилита CHKDSK

**CHKDSK** (Check Disk) — это стандартная утилита командной строки, которая проверяет файловую систему тома на наличие логических и физических ошибок.

#### Как запустить CHKDSK

Для выполнения команд, которые вносят изменения в систему, вам понадобятся права администратора.

1.  Нажмите `Win + S` или кнопку «Пуск».
2.  Введите `cmd` или «Командная строка».
3.  В результатах поиска щелкните правой кнопкой мыши по «Командная строка» и выберите **«Запустить от имени администратора»**.

#### Основные параметры (ключи) CHKDSK

Команда имеет следующий синтаксис: `chkdsk [диск:] [параметры]`

Часто используемые параметры:

*   `chkdsk C:`
    Запускает проверку диска C: в режиме «только для чтения». Утилита сообщит о найденных ошибках, но не будет их исправлять.

*   **/f**
    Исправляет ошибки на диске. Если на диске есть открытые файлы (что почти всегда так для системного диска), утилита предложит выполнить проверку при следующей перезагрузке системы.
    *Пример:* `chkdsk D: /f`

*   **/r**
    Ищет поврежденные сектора (bad sectors) и пытается восстановить информацию, которую можно прочитать. Этот ключ **включает в себя функциональность ключа `/f`**, поэтому использовать их вместе необязательно, хотя и не является ошибкой. Проверка с `/r` занимает значительно больше времени.
    *Пример:* `chkdsk D: /r`

*   **/x**
    Принудительно отключает том перед проверкой, если это необходимо. Все открытые дескрипторы для этого диска станут недействительными. Этот ключ также **включает в себя функциональность `/f`**.
    *Пример:* `chkdsk D: /x`

*   **/b** (только для файловой системы NTFS)
    Выполняет повторную оценку поврежденных кластеров на диске. Этот ключ является самым полным, так как **включает в себя функциональность `/r`**.
    *Пример:* `chkdsk C: /b`

*   **/scan** (только для NTFS)
    Запускает онлайн-проверку тома. Это означает, что диск не нужно отключать, и вы можете продолжать работать в системе во время сканирования. Однако для исправления найденных проблем потребуется следующий ключ или перезагрузка.
    *Пример:* `chkdsk C: /scan`

*   **/spotfix** (только для NTFS)
    Выполняет точечное, очень быстрое исправление ошибок на томе. Требует отключения диска, как и ключ `/f`.
    *Пример:* `chkdsk D: /spotfix`

#### Примеры запуска CHKDSK

*   **Быстрая проверка диска D: без исправления:**
    ```
    chkdsk D:
    ```

*   **Проверка и исправление ошибок на диске D:**
    ```
    chkdsk D: /f
    ```

*   **Самая полная проверка системного диска C: с поиском поврежденных секторов и их восстановлением:**
    ```
    chkdsk C: /f /r
    ```
    *или просто:*
    ```
    chkdsk C: /r
    ```

#### Что делать, если диск используется?

При попытке запустить проверку с исправлением (`/f` или `/r`) для системного диска (обычно `C:`), вы увидите сообщение:

`Невозможно выполнить команду CHKDSK, так как указанный том используется другим процессом. Следует ли выполнить проверку этого тома при следующей перезагрузке системы? (Y/N)`

Нажмите клавишу `Y`, а затем `Enter`. Проверка будет запланирована и автоматически начнется при следующей перезагрузке компьютера.

---

### Часть 2: Команды PowerShell

PowerShell — это оболочка автоматизации, которая предлагает современные и гибкие команды для управления системой.

#### Как запустить PowerShell

Как и в случае с командной строкой, вам понадобятся права администратора.

1.  Нажмите `Win + S` или кнопку «Пуск».
2.  Введите `powershell`.
3.  В результатах поиска щелкните правой кнопкой мыши по «Windows PowerShell» и выберите **«Запустить от имени администратора»**.

#### Основная команда: `Repair-Volume`

В PowerShell для проверки и исправления дисков используется командлет `Repair-Volume`.

Сначала может быть полезно посмотреть список всех томов в системе с помощью команды:
```powershell
Get-Volume
```

#### Основные параметры `Repair-Volume`

*   `-DriveLetter`
    Указывает букву диска, который нужно проверить.

*   `-Scan`
    Сканирует том на наличие ошибок и сообщает о них. Это аналог `chkdsk` без ключей.
    *Пример:* `Repair-Volume -DriveLetter D -Scan`

*   `-SpotFix`
    Выполняет быстрое онлайн-исправление без необходимости отключать том надолго. Аналог `chkdsk /spotfix`.
    *Пример:* `Repair-Volume -DriveLetter D -SpotFix`

*   `-OfflineScanAndFix`
    Выполняет полноценную проверку и исправление диска в автономном режиме. Это самый полный аналог команды `chkdsk /f /r`. Система попросит перезагрузку, если том используется.
    *Пример:* `Repair-Volume -DriveLetter C -OfflineScanAndFix`

#### Примеры PowerShell

*   **Просканировать диск C: на наличие ошибок (без исправления):**
    ```powershell
    Repair-Volume -DriveLetter C -Scan
    ```
    Вы увидите результат в поле `HealthStatus` (например, `Healthy` или `Needs-Repair`).

*   **Выполнить быстрое исправление для диска D:**
    ```powershell
    Repair-Volume -DriveLetter D -SpotFix
    ```

*   **Запланировать полную проверку и исправление системного диска C: при следующей перезагрузке:**
    ```powershell
    Repair-Volume -DriveLetter C -OfflineScanAndFix
    ```
    PowerShell, как и `chkdsk`, уведомит вас о необходимости перезагрузки и запланирует задачу.


Для большинства пользователей результат работы `chkdsk C: /r` и `Repair-Volume -DriveLetter C -OfflineScanAndFix` будет одинаковым. Выбор зависит от ваших предпочтений и задач.

**Важное замечание:** Перед любыми серьезными операциями с диском, особенно если вы подозреваете наличие физических проблем, **всегда создавайте резервную копию важных данных!** Инструменты могут исправить ошибки, но не могут гарантировать 100% сохранность информации на поврежденном носителе.